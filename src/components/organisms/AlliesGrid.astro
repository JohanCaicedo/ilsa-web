---
import { allies } from "../../lib/allies";
import { cn } from "../../lib/utils";
import GradientText from "../atoms/GradientText.astro";

interface Props {
    class?: string;
}

const { class: className } = Astro.props;

// Duplicate the array to ensure seamless looping (A + B)
// We render them inline.
const marqueeAllies = [...allies, ...allies];
---

<section
    class={cn(
        "w-full py-10 md:py-20 relative overflow-hidden bg-transparent select-none",
        className,
    )}
>
    <!-- Header -->
    <div class="text-center mb-2">
        <GradientText
            text="Red Institucional y Aliados"
            size="text-3xl md:text-3xl"
            weight="font-bold"
            from="var(--ilsa-blue-dark)"
            to="var(--ilsa-blue)"
            class="justify-center mb-4"
        />
    </div>

    <!-- Marquee Container -->
    <div
        class="overflow-hidden w-full relative z-10 max-w-[1400px] mx-auto group"
        style="mask-image: linear-gradient(to right, transparent, black 5%, black 95%, transparent); -webkit-mask-image: linear-gradient(to right, transparent, black 5%, black 95%, transparent);"
    >
        <!-- Animated Track -->
        <!-- min-w-[200%] ensures the track is at least double the container width -->
        <!-- flex ensures items are in a row -->
        <div
            class="marquee-track flex items-center min-w-[200%] will-change-transform"
        >
            {
                marqueeAllies.map((ally, index) => (
                    <div class="flex-1 flex justify-center px-4 md:px-12">
                        <img
                            src={ally.logo}
                            alt={ally.name}
                            class="h-20 md:h-24 w-auto object-contain grayscale opacity-60 hover:grayscale-0 hover:opacity-100 transition-all duration-300 pointer-events-none"
                            title={ally.name}
                            loading="lazy"
                        />
                    </div>
                ))
            }
        </div>
    </div>
</section>

<style>
    .marquee-track {
        animation: marqueeScroll 40s linear infinite;
    }

    /* Pause on hover */
    .group:hover .marquee-track {
        animation-play-state: paused;
    }

    @keyframes marqueeScroll {
        0% {
            transform: translateX(0);
        }
        100% {
            transform: translateX(-50%);
        }
    }
</style>
