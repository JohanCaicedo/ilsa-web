---
import SmartImage from "../atoms/SmartImage.astro";
interface Props {
    name: string;
    role: string;
    image: string;
    bio: string;
    xUrl?: string;
    linkedinUrl?: string;
    id?: string;
    variant?: "primary" | "secondary" | "dark" | "frosted";
}

const {
    name,
    role,
    image,
    bio,
    xUrl,
    linkedinUrl,
    id,
    variant = "dark",
} = Astro.props;

const styles = {
    name: "text-white",
    roleBorder: "border-white/30",
    roleBg: "bg-white/10",
    roleText: "text-white",
    bio: "text-white/90",
    social: "text-white/70 hover:text-white",
};
---

<button
    type="button"
    class="interactive-gradient-card relative w-80 h-[440px] rounded-xl overflow-hidden group mx-auto transition-all duration-300 hover:scale-105 hover:shadow-2xl focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-white focus-visible:ring-offset-2 focus-visible:ring-offset-transparent touch-action-manipulation"
    data-team-id={id}
    aria-label={`Ver informaciÃ³n de ${name}`}
>
    <!-- Interactive Radial Gradient Background -->
    <div
        class="gradient-bg absolute inset-0 transition-all duration-75 ease-linear"
        style="
            --x: 50%;
            --y: 50%;
            --gradient-from: var(--ilsa-blue);
            --gradient-to: var(--ilsa-mujeres);
            background-image: radial-gradient(circle at var(--x) var(--y), var(--gradient-from), var(--gradient-to));
        "
    >
    </div>

    <!-- Blue gradient overlay for better text contrast -->
    <div
        class="absolute inset-0 bg-gradient-to-br from-[#1e3a8a]/40 via-[#4e7cce]/30 to-[#1e3a8a]/50 transition-opacity duration-300 group-hover:from-[#1e3a8a]/30 group-hover:via-[#4e7cce]/20 group-hover:to-[#1e3a8a]/40 pointer-events-none"
    >
    </div>

    <!-- Content -->
    <div
        class="relative z-10 p-6 h-full w-full flex flex-col items-center justify-between text-center"
    >
        <div class="flex flex-col items-center w-full">
            <div class="relative mb-4">
                <div
                    class="absolute -inset-1 bg-white/20 rounded-full blur opacity-50 group-hover:opacity-75 transition duration-500"
                >
                </div>
                <SmartImage
                    src={image}
                    alt={name}
                    class="relative w-24 h-24 rounded-full shadow-lg object-cover border-2 border-white/50 ring-2 ring-white/20"
                />
            </div>

            <h2
                class:list={[
                    "text-xl font-extrabold mb-2 leading-tight min-h-[3.5rem] flex items-center justify-center line-clamp-2 drop-shadow-lg",
                    styles.name,
                ]}
            >
                {name}
            </h2>

            <div class="mb-4 h-8 flex items-center justify-center">
                <span
                    class:list={[
                        "inline-block px-3 py-1 rounded-full border text-[10px] font-bold uppercase tracking-wider backdrop-blur-md truncate max-w-[200px] shadow-sm",
                        styles.roleBorder,
                        styles.roleBg,
                        styles.roleText,
                    ]}
                >
                    {role}
                </span>
            </div>

            <p
                class:list={[
                    "text-xs font-medium mb-4 px-1 leading-relaxed text-pretty line-clamp-4 min-h-[4rem] drop-shadow",
                    styles.bio,
                ]}
            >
                {bio}
            </p>
        </div>

        <div
            class:list={[
                "flex space-x-4 pb-2 transition-colors duration-300",
                styles.social,
            ]}
        >
            {
                xUrl && (
                    <a
                        href={xUrl}
                        target="_blank"
                        rel="noopener noreferrer"
                        class="hover:-translate-y-0.5 transition-transform duration-300 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-white rounded"
                        aria-label={`X (Twitter) de ${name}`}
                        onclick="event.stopPropagation()"
                    >
                        <svg
                            class="w-6 h-6"
                            viewBox="0 0 24 24"
                            fill="currentColor"
                            aria-hidden="true"
                        >
                            <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z" />
                        </svg>
                    </a>
                )
            }

            {
                linkedinUrl && (
                    <a
                        href={linkedinUrl}
                        target="_blank"
                        rel="noopener noreferrer"
                        class="hover:-translate-y-0.5 transition-transform duration-300 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-white rounded"
                        aria-label={`LinkedIn de ${name}`}
                        onclick="event.stopPropagation()"
                    >
                        <svg
                            class="w-6 h-6"
                            fill="currentColor"
                            viewBox="0 0 24 24"
                            aria-hidden="true"
                        >
                            <path
                                fill-rule="evenodd"
                                d="M12.51 8.796v1.697a3.738 3.738 0 0 1 3.288-1.684c3.455 0 4.202 2.16 4.202 4.97V19.5h-3.2v-5.072c0-1.21-.244-2.766-2.128-2.766-1.827 0-2.139 1.317-2.139 2.676V19.5h-3.19V8.796h3.168ZM7.2 6.106a1.61 1.61 0 0 1-.988 1.483 1.595 1.595 0 0 1-1.743-.348A1.607 1.607 0 0 1 5.6 4.5a1.601 1.601 0 0 1 1.6 1.606Z"
                                clip-rule="evenodd"
                            />
                            <path d="M7.2 8.809H4V19.5h3.2V8.809Z" />
                        </svg>
                    </a>
                )
            }
        </div>
    </div>
</button>

<script>
    function setupInteractiveDirectorCards() {
        const cards = document.querySelectorAll(".interactive-gradient-card");

        cards.forEach((card) => {
            const gradientBg = card.querySelector(
                ".gradient-bg",
            ) as HTMLElement;
            if (!gradientBg) return;

            const handleMouseMove = (e: Event) => {
                if (!(e instanceof MouseEvent)) return;
                const rect = card.getBoundingClientRect();
                const x = e.clientX - rect.left;
                const y = e.clientY - rect.top;

                gradientBg.style.setProperty("--x", `${x}px`);
                gradientBg.style.setProperty("--y", `${y}px`);
            };

            card.addEventListener("mousemove", handleMouseMove);
        });
    }

    setupInteractiveDirectorCards();
    document.addEventListener("astro:page-load", setupInteractiveDirectorCards);
</script>
