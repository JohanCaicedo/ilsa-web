---
import type { HTMLAttributes } from "astro/types";
import { cn } from "../../lib/utils";

interface Props extends HTMLAttributes<"img"> {
    priority?: boolean;
}

const {
    src,
    alt,
    class: className,
    width,
    height,
    priority = false,
    ...rest
} = Astro.props;
---

<img
    src={src}
    alt={alt}
    width={width}
    height={height}
    loading={priority ? "eager" : "lazy"}
    fetchpriority={priority ? "high" : "auto"}
    decoding="async"
    class={cn(
        "transition-opacity duration-700 ease-in-out opacity-0 data-[loaded=true]:opacity-100",
        "translate-z-0 backface-hidden", // Safari Perf
        className,
    )}
    onload="this.setAttribute('data-loaded', 'true')"
    {...rest}
/>
