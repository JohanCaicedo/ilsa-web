---
import Layout from "../../layouts/Layout.astro";
import { getEvents } from "../../lib/wp";
import type { EventNode } from "../../lib/wp";

export const prerender = true;

export async function getStaticPaths() {
    const events = await getEvents();
    return events.map((event) => ({
        params: { slug: event.slug },
        props: { event },
    }));
}

interface Props {
    event: EventNode;
}

const { event } = Astro.props;

if (!event) {
    return Astro.redirect("/404");
}
---

<Layout title={`${event.title} - ILSA`} width="narrow">
    <article class="py-20 max-w-3xl mx-auto px-4">
        <header class="mb-12 text-center">
            <div
                class="inline-flex items-center gap-2 mb-4 text-blue-600 bg-blue-50 px-3 py-1 rounded-full text-sm font-medium"
            >
                <span>ğŸ—“ï¸ {event.eventDate || "PrÃ³ximamente"}</span>
            </div>
            {
                event.eventLocation && (
                    <div class="inline-flex items-center gap-2 mb-4 ml-2 text-slate-600 bg-slate-50 px-3 py-1 rounded-full text-sm font-medium">
                        <span>ğŸ“ {event.eventLocation}</span>
                    </div>
                )
            }
            <h1
                class="text-4xl md:text-5xl font-black mb-6 text-slate-900 leading-tight"
            >
                {event.title}
            </h1>

            {
                event.featuredImage?.node?.sourceUrl && (
                    <img
                        src={event.featuredImage.node.sourceUrl}
                        alt={event.featuredImage.node.altText || event.title}
                        class="w-full h-auto rounded-2xl shadow-lg mt-8 mb-8"
                    />
                )
            }
        </header>

        <div
            class="prose prose-lg prose-slate mx-auto max-w-none prose-headings:font-bold prose-headings:text-slate-900 prose-a:text-blue-600 prose-img:rounded-xl"
        >
            <div set:html={event.content} />
        </div>
    </article>
</Layout>
