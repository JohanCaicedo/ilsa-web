---
import Layout from "../../layouts/Layout.astro";
import { getEvents } from "../../lib/wp";
import type { EventNode } from "../../lib/wp";
import WPLoader from "../../components/molecules/WPLoader.astro";
import ArticlePost from "../../components/organisms/ArticlePost.astro";

export const prerender = true;

export async function getStaticPaths() {
    const events = await getEvents();
    return events.map((event) => ({
        params: { slug: event.slug },
        props: { event },
    }));
}

interface Props {
    event: EventNode;
}

const { event } = Astro.props;

if (!event) {
    return Astro.redirect("/404");
}
---

<Layout title={`${event.title} - ILSA`} width="narrow">
    <article class="py-20 max-w-3xl mx-auto px-4">
        <WPLoader type="article">
            <ArticlePost
                title={event.title}
                content={event.content}
                date={event.eventDate || ""}
                section="Actividades"
                url={Astro.url.href}
                featuredImage={event.featuredImage?.node?.sourceUrl}
            />
        </WPLoader>
    </article>
</Layout>
